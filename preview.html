<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My4Cuts - 启动页预览</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000000',
                        secondary: '#FFFFFF',
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .splash-animation {
                animation: fadeIn 0.8s ease-in-out forwards;
            }
            .permission-animation {
                animation: fadeIn 0.5s ease-in-out forwards;
            }
            .glass-effect {
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                background-color: rgba(255, 255, 255, 0.1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
            }
            to {
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(0);
            }
            to {
                transform: translateY(-100%);
            }
        }

        .settings-panel {
            transform: translateY(-100%);
            transition: transform 0.3s ease-in-out;
        }

        .settings-panel.active {
            transform: translateY(0);
        }
    </style>
</head>
<body class="bg-white font-inter overflow-hidden h-screen flex items-center justify-center">
    <!-- 启动页 -->
    <div id="splash-screen" class="flex flex-col items-center justify-center splash-animation opacity-0">
        <div class="text-primary text-8xl mb-6">
            <i class="fa fa-camera" aria-hidden="true"></i>
        </div>
        <h1 class="text-primary text-5xl font-bold">my4cuts</h1>
    </div>

    <!-- 权限请求页 -->
    <div id="permission-view" class="hidden flex flex-col items-center justify-center permission-animation opacity-0 w-full max-w-md px-6">
        <h2 class="text-primary text-3xl font-bold mb-6 mt-10">需要您的权限</h2>
        <p class="text-gray-600 text-center mb-10">My4Cuts需要访问您的相机和相册以捕捉和编辑照片</p>
        <div class="text-primary text-7xl mb-10">
            <i class="fa fa-camera" aria-hidden="true"></i>
        </div>
        <div class="flex flex-col space-y-4 w-full">
            <button id="allow-btn" class="bg-primary text-white py-4 px-6 rounded-full text-lg font-medium hover:bg-opacity-90 transition-all duration-300">
                允许
            </button>
            <button id="deny-btn" class="bg-white text-primary border-2 border-primary py-4 px-6 rounded-full text-lg font-medium hover:bg-gray-100 transition-all duration-300">
                不允许
            </button>
        </div>
    </div>

    <!-- 主内容页 - 相机界面 -->
    <div id="content-view" class="hidden relative permission-animation opacity-0 w-full h-full bg-black">
        <!-- 相机预览区域 -->
        <div id="camera-preview" class="absolute inset-0 flex items-center justify-center">
            <img src="https://picsum.photos/1920/1080" alt="相机预览" class="w-full h-full object-cover opacity-90">
        </div>

        <!-- 品牌标识 -->
        <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 text-white text-opacity-40 text-xs">my4cuts</div>

        <!-- 顶部状态栏 -->
        <div class="absolute top-0 left-0 right-0 flex justify-between items-center p-6 text-white text-2xl">
            <button id="back-btn" class="bg-white bg-opacity-20 text-white py-2 px-4 rounded-full text-sm font-medium hover:bg-opacity-30 transition-all duration-300 mr-4">
                <
            </button>
            <div id="dot-indicator" class="flex space-x-2 absolute left-1/2 transform -translate-x-1/2">
                <span class="block w-3 h-3 rounded-full bg-white opacity-40 transition-opacity duration-300"></span>
                <span class="block w-3 h-3 rounded-full bg-white opacity-40 transition-opacity duration-300"></span>
                <span class="block w-3 h-3 rounded-full bg-white opacity-40 transition-opacity duration-300"></span>
                <span class="block w-3 h-3 rounded-full bg-white opacity-40 transition-opacity duration-300"></span>
            </div>
            <button id="settings-btn" class="hover:text-gray-300 transition-colors duration-300 absolute right-6">
                <i class="fa fa-cog" aria-hidden="true"></i>
            </button>
        </div>

        <!-- 底部操作栏 -->
        <div class="absolute bottom-0 left-0 right-0 flex justify-between items-center p-6">
            <button id="album-btn" class="text-white text-3xl hover:text-gray-300 transition-colors duration-300">
                <i class="fa fa-image" aria-hidden="true"></i>
            </button>
            <button id="shutter-btn" class="w-20 h-20 rounded-full bg-white flex items-center justify-center hover:bg-gray-200 transition-colors duration-300">
                <div class="w-16 h-16 rounded-full bg-black"></div>
            </button>
            <button id="switch-camera-btn" class="text-white text-3xl hover:text-gray-300 transition-colors duration-300">
                <i class="fa fa-refresh" aria-hidden="true"></i>
            </button>
        </div>

        <!-- 返回按钮 (已移除，合并到顶部状态栏) -->
        // <button id="back-btn" class="absolute top-6 left-6 bg-white bg-opacity-20 text-white py-2 px-4 rounded-full text-sm font-medium hover:bg-opacity-30 transition-all duration-300">
        //     返回
        // </button>

        <!-- 倒计时视图 (默认隐藏) -->
        <div id="countdown-view" class="hidden absolute inset-0 flex items-center justify-center bg-black bg-opacity-30">
            <span id="countdown-value" class="text-white text-9xl font-bold">3</span>
        </div>

        <!-- 设置面板 (顶部下滑毛玻璃效果半透明面板，实现倒计时循环切换选项，并修改按钮文本) -->
        <div id="settings-panel" class="settings-panel absolute top-0 left-0 right-0 glass-effect border-b border-white border-opacity-20 flex flex-col p-6 text-white z-50 max-h-[80vh] overflow-y-auto">
            <!-- 拖动指示器 -->
            <div class="flex justify-center mb-4">
                <div class="w-12 h-1.5 bg-white bg-opacity-50 rounded-full"></div>
            </div>
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-2xl font-bold">设置</h3>
                <button id="close-settings-btn" class="bg-primary hover:bg-opacity-80 text-white py-2 px-4 rounded-full text-sm font-medium transition-all duration-300">
                    完成
                </button>
            </div>
            <div class="flex flex-col space-y-8">
                <div class="flex flex-col space-y-2">
                    <span class="text-lg">倒计时</span>
                    <div class="flex space-x-3">
                        <button id="countdown-off-btn" class="bg-white text-primary py-2 px-4 rounded-full text-sm font-medium hover:bg-opacity-90 transition-all duration-300">
                            关闭
                        </button>
                        <button id="countdown-3s-btn" class="bg-gray-700 text-white py-2 px-4 rounded-full text-sm font-medium hover:bg-primary transition-all duration-300">
                            3s
                        </button>
                        <button id="countdown-6s-btn" class="bg-gray-700 text-white py-2 px-4 rounded-full text-sm font-medium hover:bg-primary transition-all duration-300">
                            6s
                        </button>
                    </div>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-lg">关闭快门声</span>
                    <div class="flex items-center space-x-3">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="shutter-sound-toggle" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-400 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                        </label>
                        <div class="relative w-12 h-6 flex items-center justify-center">
                            <span class="text-xs font-medium transition-opacity duration-300 peer-checked:opacity-0 absolute left-0 right-0 text-center" id="off-text">OFF</span>
                            <span class="text-xs font-medium transition-opacity duration-300 opacity-0 peer-checked:opacity-100 absolute left-0 right-0 text-center" id="on-text">ON</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 启动页逻辑
        document.addEventListener('DOMContentLoaded', function() {
            const splashScreen = document.getElementById('splash-screen');
            const permissionView = document.getElementById('permission-view');
            const contentView = document.getElementById('content-view');
            const allowBtn = document.getElementById('allow-btn');
            const denyBtn = document.getElementById('deny-btn');
            const backBtn = document.getElementById('back-btn');

            // 相机界面元素
            const settingsBtn = document.getElementById('settings-btn');
            const switchCameraBtn = document.getElementById('switch-camera-btn');
            const albumBtn = document.getElementById('album-btn');
            const shutterBtn = document.getElementById('shutter-btn');
            const countdownView = document.getElementById('countdown-view');
            const countdownValue = document.getElementById('countdown-value');
            const captureCount = document.getElementById('capture-count');
            const settingsPanel = document.getElementById('settings-panel');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            const cameraPreview = document.getElementById('camera-preview');
            const previewImage = cameraPreview.querySelector('img');
            const shutterSoundToggle = document.getElementById('shutter-sound-toggle');
            const countdownOffBtn = document.getElementById('countdown-off-btn');
            const countdown3sBtn = document.getElementById('countdown-3s-btn');
            const countdown6sBtn = document.getElementById('countdown-6s-btn');

            // 状态变量
            let currentCount = 0;
            let isFrontCamera = false;
            let countdownInterval;
            let countdownMode = 'off'; // 'off', '3s', '6s'

            // 2秒后自动跳转到权限请求页，添加平滑过渡
            setTimeout(() => {
                splashScreen.style.transition = 'opacity 0.8s ease-out';
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.classList.add('hidden');
                    permissionView.classList.remove('hidden');
                    permissionView.classList.remove('opacity-0');
                    permissionView.classList.add('permission-animation');
                }, 800);
            }, 2000);

            // 允许按钮点击事件
            allowBtn.addEventListener('click', function() {
                permissionView.classList.add('hidden');
                contentView.classList.remove('hidden');
                contentView.classList.remove('opacity-0');
                contentView.classList.add('permission-animation');
            });

            // 不允许按钮点击事件
            denyBtn.addEventListener('click', function() {
                alert('没有相机和相册权限，应用将无法正常工作。请在设置中启用权限。');
            });

            // 返回按钮点击事件
            backBtn.addEventListener('click', function() {
                contentView.classList.add('hidden');
                splashScreen.classList.remove('hidden');
                splashScreen.classList.remove('opacity-0');
                splashScreen.classList.add('splash-animation');

                // 重置计数
                currentCount = 0;
                updateCaptureCount();
            });

            // 设置按钮点击事件
            settingsBtn.addEventListener('click', function() {
                settingsPanel.classList.add('active');
            });

            // 关闭设置按钮点击事件
            closeSettingsBtn.addEventListener('click', function() {
                settingsPanel.classList.remove('active');
            });

            // 切换相机按钮点击事件
            switchCameraBtn.addEventListener('click', function() {
                isFrontCamera = !isFrontCamera;
                // 切换预览图像 (模拟前后摄像头切换)
                if (isFrontCamera) {
                    previewImage.src = 'https://picsum.photos/1920/1080?random=1';
                } else {
                    previewImage.src = 'https://picsum.photos/1920/1080?random=2';
                }
            });

            // 相册按钮点击事件
            albumBtn.addEventListener('click', function() {
                alert('相册功能将在这里实现');
            });

            // 倒计时按钮点击事件
            countdownOffBtn.addEventListener('click', function() {
                countdownMode = 'off';
                updateCountdownButtons();
            });

            countdown3sBtn.addEventListener('click', function() {
                countdownMode = '3s';
                updateCountdownButtons();
            });

            countdown6sBtn.addEventListener('click', function() {
                countdownMode = '6s';
                updateCountdownButtons();
            });

            // 更新倒计时按钮状态
            function updateCountdownButtons() {
                // 重置所有按钮样式
                countdownOffBtn.classList.remove('bg-primary', 'text-white');
                countdown3sBtn.classList.remove('bg-primary', 'text-white');
                countdown6sBtn.classList.remove('bg-primary', 'text-white');
                countdownOffBtn.classList.add('bg-gray-700', 'text-white');
                countdown3sBtn.classList.add('bg-gray-700', 'text-white');
                countdown6sBtn.classList.add('bg-gray-700', 'text-white');

                // 设置当前选中按钮样式
                if (countdownMode === 'off') {
                    countdownOffBtn.classList.remove('bg-gray-700', 'text-white');
                    countdownOffBtn.classList.add('bg-white', 'text-primary');
                } else if (countdownMode === '3s') {
                    countdown3sBtn.classList.remove('bg-gray-700', 'text-white');
                    countdown3sBtn.classList.add('bg-primary', 'text-white');
                } else if (countdownMode === '6s') {
                    countdown6sBtn.classList.remove('bg-gray-700', 'text-white');
                    countdown6sBtn.classList.add('bg-primary', 'text-white');
                }
            }

            // 快门按钮点击事件
            shutterBtn.addEventListener('click', function() {
                if (countdownMode !== 'off') {
                    // 启用倒计时
                    const time = parseInt(countdownMode);
                    startCountdown(time);
                } else {
                    // 直接拍摄
                    capturePhoto();
                }
            });

            // 初始化圆点指示器
            updateCaptureCount();
            // 初始化倒计时按钮
            updateCountdownButtons();

            // 实现从顶部向下轻滑呼出设置面板
            let startY = 0;
            document.addEventListener('touchstart', function(e) {
                startY = e.touches[0].clientY;
            }, false);

            document.addEventListener('touchmove', function(e) {
                if (startY < 50) { // 只在顶部区域响应
                    const currentY = e.touches[0].clientY;
                    if (currentY - startY > 50) { // 下滑超过50px
                        settingsPanel.classList.add('active');
                    }
                }
            }, false);

            // 开始倒计时
            function startCountdown(time) {
                countdownValue.textContent = time;
                countdownView.classList.remove('hidden');

                let currentTime = time;
                countdownInterval = setInterval(() => {
                    currentTime--;
                    countdownValue.textContent = currentTime;

                    if (currentTime <= 0) {
                        clearInterval(countdownInterval);
                        countdownView.classList.add('hidden');
                        capturePhoto();
                    }
                }, 1000);
            }

            // 拍摄照片
            function capturePhoto() {
                // 模拟闪光灯效果
                flashScreen();

                // 模拟快门声
                if (!shutterSoundToggle.checked) { // 关闭快门声选项，当开关关闭时播放声音
                    playShutterSound();
                }

                // 更新计数
                currentCount++;
                updateCaptureCount();

                // 模拟拍照效果
                cameraPreview.classList.add('scale-95');
                setTimeout(() => {
                    cameraPreview.classList.remove('scale-95');
                }, 200);

                // 检查是否拍满4张
                if (currentCount >= 4) {
                    setTimeout(() => {
                        alert('已完成4张照片拍摄！');
                        currentCount = 0;
                        updateCaptureCount();
                    }, 1000);
                }
            }

            // 更新拍摄计数和圆点指示器
            function updateCaptureCount() {
                // 更新圆点指示器
                const dots = document.querySelectorAll('#dot-indicator span');
                dots.forEach((dot, index) => {
                    if (index < currentCount) {
                        dot.classList.remove('opacity-40');
                        dot.classList.add('opacity-100');
                    } else {
                        dot.classList.remove('opacity-100');
                        dot.classList.add('opacity-40');
                    }
                });
            }

            // 模拟闪光灯效果
            function flashScreen() {
                const flashView = document.createElement('div');
                flashView.className = 'fixed inset-0 bg-white z-50 opacity-0';
                document.body.appendChild(flashView);

                setTimeout(() => {
                    flashView.style.transition = 'opacity 0.1s ease-in-out';
                    flashView.style.opacity = '1';

                    setTimeout(() => {
                        flashView.style.transition = 'opacity 0.3s ease-in-out';
                        flashView.style.opacity = '0';

                        setTimeout(() => {
                            document.body.removeChild(flashView);
                        }, 300);
                    }, 100);
                }, 10);
            }

            // 模拟快门声
            function playShutterSound() {
                // 在浏览器中模拟声音
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.01);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.1);

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
            }
        });
    </script>
        <script>
            // 快门声开关状态同步
            const shutterSoundToggle = document.getElementById('shutter-sound-toggle');
            const onText = document.getElementById('on-text');
            const offText = document.getElementById('off-text');

            shutterSoundToggle.addEventListener('change', function() {
                if (this.checked) {
                    onText.style.opacity = '1';
                    offText.style.opacity = '0';
                } else {
                    onText.style.opacity = '0';
                    offText.style.opacity = '1';
                }
            });

            // 初始化状态
            if (shutterSoundToggle.checked) {
                onText.style.opacity = '1';
                offText.style.opacity = '0';
            } else {
                onText.style.opacity = '0';
                offText.style.opacity = '1';
            }
        </script>
</body>
</html>